{% extends "support/base.html.jinja" %}
{% block title %}
    {% if g.page %}
        {{ g.page.title | e }} - {{ super() }}
    {% else %}
        {{ super() }}
    {% endif %}
{% endblock %}
{% block content %}
    {% if query.submitted %}
        {% if error %}
            <div id="info-box" class="red-box"><p>
                {% if error.code == ErrorCode.BAD_ACTION %}
                    Unknown action: <b><span class="mono">{{ query.action | e }}</span></b>.
                {% elif error.code == ErrorCode.NO_SEARCH_METHOD %}
                    No copyvio search methods were selected. A check can only be made using the search engine, links present in the page, Turnitin, or some combination of these.
                {% elif error.code == ErrorCode.BAD_OLDID %}
                    The revision ID <code>{{ query.oldid | e }}</code> is invalid. It should be an integer.
                {% elif error.code == ErrorCode.NO_URL %}
                    Compare mode requires a URL to be entered. Enter one in the text box below, or choose copyvio search mode to look for content similar to the article elsewhere on the web.
                {% elif error.code == ErrorCode.BAD_URI %}
                    Unsupported URI scheme: <a href="{{ query.url | e }}">{{ query.url | e }}</a>.
                {% elif error.code == ErrorCode.NO_DATA %}
                    Couldn't find any text in <a href="{{ query.url | e }}">{{ query.url | e }}</a>. <i>Note:</i> only HTML documents, plain text pages, and PDFs are supported, and content generated by JavaScript or found inside iframes is ignored.
                {% elif error.code == ErrorCode.TIMEOUT %}
                    The URL <a href="{{ query.url | e }}">{{ query.url | e }}</a> timed out before any data could be retrieved.
                {% elif error.code == ErrorCode.SEARCH_ERROR %}
                    An error occurred while using the search engine ({{ error.__cause__ }}). <i>Note:</i> there is a daily limit on the number of search queries the tool is allowed to make. You may <a href="{{ request.url | httpsfix | e }}&amp;use_engine=0">repeat the check without using the search engine</a>.
                {% else %}
                    An unknown error occurred.
                {% endif %}
            </p></div>
        {% elif not g.site %}
            <div id="info-box" class="red-box">
                <p>The given site (project=<b><span class="mono">{{ query.project | e }}</span></b>, language=<b><span class="mono">{{ query.lang | e }}</span></b>) doesn't seem to exist. It may also be closed or private. <a href="https://{{ query.lang | e }}.{{ query.project | e }}.org/">Confirm its URL.</a></p>
            </div>
        {% elif query.oldid and not result %}
            <div id="info-box" class="red-box">
                <p>The revision ID couldn't be found: <a href="https://{{ g.site.domain | e }}/w/index.php?oldid={{ query.oldid | e }}">{{ query.oldid | e }}</a>.</p>
            </div>
        {% elif query.title and not result %}
            <div id="info-box" class="red-box">
                <p>The page couldn't be found: <a href="{{ g.page.url }}">{{ g.page.title | e }}</a>.</p>
            </div>
        {% endif %}
    {% endif %}
    <p>This tool attempts to detect <a href="https://en.wikipedia.org/wiki/WP:COPYVIO">copyright violations</a> in articles. In <i>search mode</i>, it will check for similar content elsewhere on the web using <a href="https://developers.google.com/custom-search/">Google</a>, external links present in the text of the page, or <a href="https://en.wikipedia.org/wiki/Wikipedia:Turnitin">Turnitin</a> (via <a href="https://en.wikipedia.org/wiki/User:EranBot">EranBot</a>), depending on which options are selected. In <i>compare mode</i>, the tool will compare the article to a specific webpage without making additional searches, like the <a href="https://dupdet.toolforge.org/">Duplication Detector</a>.</p>
    <p>Running a full check can take up to a minute if other websites are slow or if the tool is under heavy use. Please be patient. If you get a timeout, wait a moment and refresh the page.</p>
    <p>Be aware that other websites can copy from Wikipedia, so check the results carefully, especially for older or well-developed articles. Specific websites can be skipped by adding them to the <a href="https://en.wikipedia.org/wiki/User:EarwigBot/Copyvios/Exclusions">excluded URL list</a>.</p>
    {% include "support/cv_form.html.jinja" %}
    {% if result %}
        {% include "support/cv_result.html.jinja" %}
    {% endif %}
{% endblock %}
