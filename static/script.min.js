function updateScreenSize(){var cache=cacheCookie(),data={width:window.screen.availWidth,height:window.screen.availHeight};cache&&cache.width==data.width&&cache.height==data.height||setCookie("CopyviosScreenCache",JSON.stringify(data),1095)}function cacheCookie(){var cookie=getCookie("CopyviosScreenCache");if(cookie)try{data=JSON.parse(cookie);var width=data.width,height=data.height;if(width&&height)return{width:width,height:height}}catch(SyntaxError){}return!1}function getCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ)){var value=window.atob(c.substring(nameEQ.length,c.length));if(0==value.indexOf("--cpv2"))return value.substring("--cpv2".length,value.length)}}return null}function setCookieWithDate(name,value,expires){value=window.btoa("--cpv2"+value),expires=expires?";expires="+expires.toUTCString():"",document.cookie=name+"="+value+expires+";path=/;samesite=lax"}function setCookie(name,value,days){var date;days?((date=new Date).setTime(date.getTime()+24*days*60*60*1e3),setCookieWithDate(name,value,date)):setCookieWithDate(name,value)}function selectTab(menu){var tab=$(menu.target);if(tab.hasClass("oo-ui-optionWidget-selected"))return!1;var name=tab.data("name"),menu=tab.closest(".oo-ui-menuLayout");return menu.find(".oo-ui-optionWidget-selected").removeClass("oo-ui-optionWidget-selected").attr("aria-selected","false"),tab.addClass("oo-ui-optionWidget-selected").attr("aria-selected","true"),menu.find(".oo-ui-tabPanelLayout-active").removeClass("oo-ui-tabPanelLayout-active").addClass("oo-ui-element-hidden").attr("aria-hidden","true"),menu.find('.oo-ui-tabPanelLayout[data-name="'+name+'"]').addClass("oo-ui-tabPanelLayout-active").removeClass("oo-ui-element-hidden").removeAttr("aria-hidden"),!1}function submitForm(){$("#cv-form button[type='submit']").prop("disabled",!0).css("cursor","progress").parent().addClass("oo-ui-widget-disabled").removeClass("oo-ui-widget-enabled")}function toggleNotice(){var details=$("#notice-collapse-box"),trigger=$("#notice-collapse-trigger");details.is(":hidden")?(details.show(),trigger.text("[hide]")):(details.hide(),trigger.text("[show]"))}function setNotice(){var details=$("#notice-collapse-box"),trigger=$("#notice-collapse-trigger");0<=details.length&&0<=trigger.length&&(trigger.replaceWith($("<a>",{id:"notice-collapse-trigger",href:"#",text:"[show]",click:function(){return toggleNotice(),!1}})),details.hide())}function addUrl(){var template=$("#compare-new-url"),widget=template[0].content.cloneNode(!0);return $(widget).find("input").prop("name","url"+($(".compare-url").length+1)),$(widget).find(".compare-remove-url").click(removeUrl),template.before(widget),!1}function removeUrl(e){return $(e.target).closest(".oo-ui-layout").remove(),$(".compare-url:not(.compare-url-first)").each(function(i,e){$(e).find("input").prop("name","url"+(i+2))}),!1}function pasteText(){return!1}function uploadFile(){return!1}function selectResult(n){var select=$(".cv-chain-source-"+n);0!==select.length&&($(".cv-chain-source").addClass("hidden"),select.removeClass("hidden"),$(".source-row-selected").removeClass("source-row-selected"),$($(".source-row")[n-1]).addClass("source-row-selected"),$(".source-tooltip > .tooltip-align-right").remove(),$(".source-tooltip-selected").removeClass("source-tooltip-selected"),$(".source-tooltip").filter(function(i,elem){return elem.dataset.id===n.toString()}).addClass("source-tooltip-selected"))}function setResultSelectionHandlers(){$(".source-compare").click(function(e){return selectResult($(e.target).data("id")),!1}),$("#cv-result-sources tr:not(:first-child)").click(function(e){if("TD"===e.target.tagName)return selectResult($(e.target).parent().data("id")),!1})}function toggleSource(id){var el=$(id.target),id=el.data("id");return el.hasClass("cv-hl")?$(".cv-hl-"+id).addClass("cv-hl-disabled-"+id).removeClass(["cv-hl-"+id,"cv-hl"]):$(".cv-hl-disabled-"+id).addClass(["cv-hl-"+id,"cv-hl"]).removeClass("cv-hl-disabled-"+id),!1}function unselectRegions(){if(0<$(".source-tooltip, .cv-selected").length)return $(".source-tooltip").remove(),$(".cv-selected").removeClass("cv-selected"),!1}function selectRegion(e){unselectRegions();var target=$(e.target).closest(".cv-hl");if(0!==target.length){var width=[].slice.apply(target[0].classList).filter(function(c){return c.startsWith("cv-hl-")});if(0!==width.length){var num=parseInt(width[0].substr(6)),tooltip=null,selected=!0;if(0<$("#cv-result-sources").length){if(0===(tooltip=$(".source-url-"+num)).length)return;selected=$(".source-row-selected").data("id")===num}var tooltipDirection=target.text().split(/\s+/).filter(function(s){return""!=s}).length,contents=$("<span>"),width=null!==tooltip?(containerOffset=tooltip.data("domain")||tooltip.text(),contents.append($("<a>",{class:"selector",href:"#",title:"Select source"}).text("Source "+num).click(function(){return selectResult(num),!1})).append($("<strong>",{class:"selector"}).text("Source "+num)).append(" ").append($("<span>",{class:"domain"}).text("("+containerOffset+"):")).append(" "),Math.min(15+containerOffset.length/2,30)):8;contents.append($("<span>",{class:"wordcount"}).text(tooltipDirection.toString()+" words")).click(function(){return $(".source-row-selected").data("id")===num?unselectRegions():selectResult(num),!1});var tooltip=$("#source-tooltips"),containerOffset=tooltip.offset(),tooltipDirection=target.closest(".cv-chain-cell").hasClass("cv-chain-source")?"right":"left",tooltip=$("<div>",{class:"source-tooltip tooltip-anchor-fixed"}).css({top:e.pageY-containerOffset.top+"px",left:e.pageX-containerOffset.left+"px"}).append($("<span>",{class:"tooltip tooltip-align-"+tooltipDirection}).css({width:width+"em"}).append(contents)).appendTo(tooltip).attr("data-id",num.toString());return selected&&tooltip.addClass("source-tooltip-selected"),target.addClass("cv-selected"),!1}}}function hideAdditionalSources(){0<=$("#cv-additional").length&&($("#cv-additional").css("display","block"),$(".source-default-hidden").css("display","none"),$("#show-additional-sources").click(function(){return $(".source-default-hidden").css("display",""),$("#cv-additional").css("display","none"),!1}))}$(document).ready(function(){$(".oo-ui-optionWidget").click(selectTab),$("#compare-add-url").click(addUrl),$("#compare-paste").click(pasteText),$("#compare-upload").click(uploadFile),$(".compare-remove-url").click(removeUrl),setResultSelectionHandlers(),$(".source-num-included").click(toggleSource),$(".cv-chain-cell .cv-hl").click(selectRegion),$("body").click(unselectRegions),$(document).keyup(function(e){if("Escape"===e.key)return unselectRegions()}),$("#cv-form").submit(submitForm),hideAdditionalSources(),setNotice()});